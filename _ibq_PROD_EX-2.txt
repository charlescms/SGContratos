SELECT   DISTINCT
  Sum(CONTRATOTRANSPORTE2.QUANTIDADETOTAL) 	            AS QuantidadeTotal,
  Sum(CONTRATOTRANSPORTE2.VALORSCCTOTAL)   	            AS VALORSCCTOTAL ,
  Sum(CONTRATOTRANSPORTE2.QUANTTOTALEXP)   	            AS QUANTTOTALEXP,
  Sum(CONTRATOTRANSPORTE2.VALORTOTALEXP)   	            AS VALORTOTALEXP,
  sum(CONTRATOTRANSPORTE2.QUANTIDADETOTAL - CONTRATOTRANSPORTE2.QUANTTOTALEXP ) AS QUANTADEPENDENTE ,
  sum(CONTRATOTRANSPORTE2.VALORSCCTOTAL - CONTRATOTRANSPORTE2.VALORTOTALEXP ) AS VALORTOTALPENDENTE ,
  Sum(CONTRATOTRANSPORTE2.VALORTOTALCOMISSAO)           	AS VALORTOTALCOMISSAO ,
  Sum(CONTRATOTRANSPORTE2.ValorTotalComissaoExecutado)  	AS ValorTotalComissaoExecutado ,
  Sum(CONTRATOTRANSPORTE2.VALORTOTALCOMISSAO - CONTRATOTRANSPORTE2.ValorTotalComissaoExecutado ) AS VlTotalComissaoPendente ,
  CONTRATOTRANSPORTE.NOMEMIX                 as NOMEMIX ,
  PRODUTOs.QUANT_PREVISTA                              as QUANT_PREVISTA ,
  PRODUTOs.VALOR_PREVISTO                              as VALOR_PREVISTO
FROM CONTRATOTRANSPORTE ,  PRODUTOS ,
   (
      SELECT  DISTINCT
        CONTRATOTRANSPORTE.CONTRATO ,
       (SELECT IIF(SUM( PRODUTOCONTRATOT.QUANTIDADE)       IS NULL ,0,SUM(PRODUTOCONTRATOT.QUANTIDADE) )       FROM PRODUTOCONTRATOT  WHERE ( CONTRATOTRANSPORTE.CONTRATO = PRODUTOCONTRATOT.CONTRATO  ) AND  PRODUTOCONTRATOT.CADASTRO >= '2012/12/01' AND  PRODUTOCONTRATOT.CADASTRO <= '2013/10/09' )  AS  QUANTIDADETOTAL,
       (SELECT IIF(SUM( PRODUTOCONTRATOT.VALORSCC)         IS NULL ,0,SUM(PRODUTOCONTRATOT.VALORSCC) )         FROM PRODUTOCONTRATOT  WHERE ( CONTRATOTRANSPORTE.CONTRATO = PRODUTOCONTRATOT.CONTRATO  ) AND  PRODUTOCONTRATOT.CADASTRO >= '2012/12/01' AND  PRODUTOCONTRATOT.CADASTRO <= '2013/10/09' )  AS  VALORSCCTOTAL,
       (SELECT IIF(SUM( EXPORTADOTRANSITO.QUANTIDADEEXP)   IS NULL ,0,SUM(EXPORTADOTRANSITO.QUANTIDADEEXP) )   FROM EXPORTADOTRANSITO WHERE ( CONTRATOTRANSPORTE.CONTRATO = EXPORTADOTRANSITO.CONTRATO ) AND  EXPORTADOTRANSITO.CADASTRO >= '2012/12/01' AND  EXPORTADOTRANSITO.CADASTRO <= '2013/10/09' )  AS  QUANTTOTALEXP,
       (SELECT IIF(SUM( EXPORTADOTRANSITO.VALOR)           IS NULL ,0,SUM(EXPORTADOTRANSITO.VALOR) )           FROM EXPORTADOTRANSITO WHERE ( CONTRATOTRANSPORTE.CONTRATO = EXPORTADOTRANSITO.CONTRATO ) AND  EXPORTADOTRANSITO.CADASTRO >= '2012/12/01' AND  EXPORTADOTRANSITO.CADASTRO <= '2013/10/09' )  AS  VALORTOTALEXP,
       (SELECT IIF(SUM( PRODUTOCONTRATOT.COMISAOSFATURA)   IS NULL ,0,SUM(PRODUTOCONTRATOT.COMISAOSFATURA) )   FROM PRODUTOCONTRATOT  WHERE ( CONTRATOTRANSPORTE.CONTRATO = PRODUTOCONTRATOT.CONTRATO  ) AND  PRODUTOCONTRATOT.CADASTRO >= '2012/12/01' AND  PRODUTOCONTRATOT.CADASTRO <= '2013/10/09' )  AS  VALORTOTALCOMISSAO,
       (SELECT IIF(SUM( EXPORTADOTRANSITO.COMISAOSFATURA) IS NULL ,0,SUM(EXPORTADOTRANSITO.COMISAOSFATURA) ) FROM EXPORTADOTRANSITO WHERE ( CONTRATOTRANSPORTE.CONTRATO = EXPORTADOTRANSITO.CONTRATO ) AND  EXPORTADOTRANSITO.CADASTRO >= '2012/12/01' AND  EXPORTADOTRANSITO.CADASTRO <= '2013/10/09' and EXPORTADOTRANSITO.numnfemit is not null  )  AS  VALORTOTALCOMISSAOEXECUTADO
      FROM
        CONTRATOTRANSPORTE , PRODUTOCONTRATOT
      where ( ContratoTransporte.Contrato = PRODUTOCONTRATOT.Contrato )
        AND   CONTRATOTRANSPORTE.CLICOD >=  1
		AND CONTRATOTRANSPORTE.CLICOD <=  1
		AND  PRODUTOCONTRATOT.CADASTRO >= '2012/12/01'
		AND  PRODUTOCONTRATOT.CADASTRO <= '2013/10/09'
		)  AS  CONTRATOTRANSPORTE2
 where ( CONTRATOTRANSPORTE2.CONTRATO = CONTRATOTRANSPORTE.CONTRATO )
   AND   CONTRATOTRANSPORTE.NOMEMIX = PRODUTOs.PRODUTO
   AND   CONTRATOTRANSPORTE.CLICOD >=  1
   AND   CONTRATOTRANSPORTE.CLICOD <=  1
   AND ( CONTRATOTRANSPORTE.FORCOD =  ( SELECT FORCOD FROM FORNECEDORES  WHERE  (Fornecedores.RAZAO LIKE '%SURIMPEX%' )))
 GROUP BY CONTRATOTRANSPORTE.NOMEMIX     ,PRODUTOs.QUANT_PREVISTA, PRODUTOs.VALOR_PREVISTO
